<UserControl x:Class="eStarter.Views.SettingsPage"
             xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
             xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
             FontFamily="Microsoft YaHei UI, Segoe UI">
    
    <Grid Background="{DynamicResource MetroBackgroundBrush}">
        <Grid.ColumnDefinitions>
            <ColumnDefinition Width="320"/>
            <ColumnDefinition Width="*"/>
        </Grid.ColumnDefinitions>

        <!-- Sidebar -->
        <Border Background="{DynamicResource MetroBackgroundBrush}" BorderBrush="{DynamicResource MetroSeparatorBrush}" BorderThickness="0,0,1,0">
            <Grid Margin="40,0,0,0">
                <Grid.RowDefinitions>
                    <RowDefinition Height="Auto"/>
                    <RowDefinition Height="*"/>
                </Grid.RowDefinitions>
                
                <!-- Header aligned with Back Button (30 margin + 48 button + 12 gap = 90) -->
                <TextBlock Text="{DynamicResource Str_PCSettings}" FontFamily="Microsoft YaHei UI Light, Segoe UI Light" FontSize="24" Foreground="{DynamicResource MetroForegroundBrush}" Margin="50,38,0,30"/>
                
                <ScrollViewer Grid.Row="1" VerticalScrollBarVisibility="Auto" PanningMode="VerticalOnly">
                    <ListBox x:Name="SettingsNav" 
                             Background="Transparent" 
                             BorderThickness="0" 
                             ItemContainerStyle="{StaticResource SettingsListBoxItemStyle}"
                             SelectionChanged="SettingsNav_SelectionChanged"
                             FontFamily="Microsoft YaHei UI, Segoe UI"
                              Padding="10,8">
                        <ListBoxItem Content="{DynamicResource Str_Personalization}" Tag="Personalization" IsSelected="True"/>
                        <ListBoxItem Content="{DynamicResource Str_SearchApps}" Tag="SearchApps"/>
                        <ListBoxItem Content="{DynamicResource Str_Privacy}" Tag="Privacy"/>
                        <ListBoxItem Content="{DynamicResource Str_TimeLanguage}" Tag="TimeLanguage"/>
                        <ListBoxItem Content="{DynamicResource Str_EaseAccess}" Tag="EaseAccess"/>
                        <ListBoxItem Content="{DynamicResource Str_UpdateRecovery}" Tag="UpdateRecovery"/>
                        <ListBoxItem Content="{DynamicResource Str_About}" Tag="About"/>
                    </ListBox>
                </ScrollViewer>
            </Grid>
        </Border>

        <!-- Content Area -->
        <ScrollViewer Grid.Column="1" VerticalScrollBarVisibility="Auto" PanningMode="VerticalOnly">
            <Grid Margin="40,100,40,40">
                <!-- Personalization Panel -->
                <StackPanel x:Name="PersonalizationPanel">
                    <TextBlock Text="{DynamicResource Str_Personalization}" Style="{StaticResource MetroHeaderTextStyle}"/>
                    
                    <TextBlock Text="{DynamicResource Str_StartScreen}" Style="{StaticResource MetroSubheaderTextStyle}" Margin="0,20,0,10"/>
                    <StackPanel Orientation="Horizontal" Margin="0,0,0,20">
                        <TextBlock Text="{DynamicResource Str_Theme}" Style="{StaticResource MetroBodyTextStyle}" VerticalAlignment="Center" Width="150"/>
                        <ComboBox Width="200" Height="30" Style="{StaticResource MetroComboBoxStyle}"
                                  SelectedValue="{Binding CurrentSettings.Theme, Mode=TwoWay}"
                                  SelectedValuePath="Content"
                                  SelectionChanged="Theme_SelectionChanged">
                            <ComboBoxItem Content="Dark"/>
                            <ComboBoxItem Content="Light"/>
                        </ComboBox>
                    </StackPanel>

                    <StackPanel Orientation="Horizontal" Margin="0,0,0,30">
                        <TextBlock Text="{DynamicResource Str_AccentColor}" Style="{StaticResource MetroBodyTextStyle}" VerticalAlignment="Center" Width="150"/>
                        <ComboBox Width="200" Height="30" Style="{StaticResource MetroComboBoxStyle}"
                                  ItemsSource="{Binding AvailableAccentColors}"
                                  SelectedValue="{Binding CurrentSettings.AccentColor, Mode=TwoWay}"
                                  SelectionChanged="AccentColor_SelectionChanged">
                            <ComboBox.ItemTemplate>
                                <DataTemplate>
                                    <StackPanel Orientation="Horizontal">
                                        <Border Width="20" Height="20" Margin="0,0,10,0" BorderThickness="1" BorderBrush="#33FFFFFF">
                                            <Border.Background>
                                                <SolidColorBrush Color="{Binding}"/>
                                            </Border.Background>
                                        </Border>
                                        <TextBlock Text="{Binding}" VerticalAlignment="Center" Foreground="{DynamicResource MetroForegroundBrush}"/>
                                    </StackPanel>
                                </DataTemplate>
                            </ComboBox.ItemTemplate>
                        </ComboBox>
                    </StackPanel>

                    <StackPanel Orientation="Horizontal" Margin="0,0,0,30">
                        <TextBlock Text="{DynamicResource Str_Animations}" Style="{StaticResource MetroBodyTextStyle}" VerticalAlignment="Center" Width="150"/>
                        <CheckBox IsChecked="True" VerticalAlignment="Center">
                            <TextBlock Text="{DynamicResource Str_EnableAnimations}" Style="{StaticResource MetroBodyTextStyle}" Margin="5,0,0,0"/>
                        </CheckBox>
                    </StackPanel>

                    <StackPanel Orientation="Horizontal" Margin="0,0,0,30">
                        <TextBlock Text="{DynamicResource Str_TimeDisplay}" Style="{StaticResource MetroBodyTextStyle}" VerticalAlignment="Center" Width="150"/>
                        <CheckBox IsChecked="{Binding ShowTime, Mode=TwoWay}" VerticalAlignment="Center">
                            <TextBlock Text="{DynamicResource Str_ShowTime}" Style="{StaticResource MetroBodyTextStyle}" Margin="5,0,0,0"/>
                        </CheckBox>
                    </StackPanel>
                </StackPanel>

                <!-- Update and Recovery Panel -->
                <StackPanel x:Name="UpdateRecoveryPanel" Visibility="Collapsed">
                    <TextBlock Text="{DynamicResource Str_UpdateRecovery}" Style="{StaticResource MetroHeaderTextStyle}"/>
                    
                    <TextBlock Text="{DynamicResource Str_Recovery}" Style="{StaticResource MetroSubheaderTextStyle}" Margin="0,20,0,10"/>
                    <TextBlock Text="{DynamicResource Str_RefreshPC}" Style="{StaticResource MetroBodyTextStyle}" Margin="0,0,0,5"/>
                    <TextBlock Text="{DynamicResource Str_RefreshPCDesc}" 
                               Style="{StaticResource MetroBodyTextStyle}" FontSize="14" Opacity="0.7" Margin="0,0,0,15"/>
                    
                    <Button Content="{DynamicResource Str_GetStarted}" 
                            Width="140" Height="36"
                            HorizontalAlignment="Left"
                            Background="#FF333333" Foreground="White" BorderThickness="2" BorderBrush="#FF888888"
                            Cursor="Hand" Margin="0,0,0,30"/>

                    <TextBlock Text="{DynamicResource Str_RemoveEverything}" Style="{StaticResource MetroSubheaderTextStyle}" Margin="0,10,0,10"/>
                    <TextBlock Text="{DynamicResource Str_RemoveEverythingDesc}" 
                               Style="{StaticResource MetroBodyTextStyle}" FontSize="14" Opacity="0.7" Margin="0,0,0,15"/>
                    
                    <Button Content="{DynamicResource Str_ResetAppData}" 
                            Width="160" Height="36"
                            HorizontalAlignment="Left"
                            Background="#FFCC0000" Foreground="White" BorderThickness="0"
                            Cursor="Hand"
                            Click="ResetAppData_Click">
                        <Button.Template>
                            <ControlTemplate TargetType="Button">
                                <Border x:Name="border" Background="{TemplateBinding Background}">
                                    <ContentPresenter HorizontalAlignment="Center" VerticalAlignment="Center"/>
                                </Border>
                                <ControlTemplate.Triggers>
                                    <Trigger Property="IsMouseOver" Value="True">
                                        <Setter TargetName="border" Property="Background" Value="#FF990000"/>
                                    </Trigger>
                                    <Trigger Property="IsPressed" Value="True">
                                        <Setter TargetName="border" Property="Background" Value="#FF660000"/>
                                    </Trigger>
                                </ControlTemplate.Triggers>
                            </ControlTemplate>
                        </Button.Template>
                    </Button>
                </StackPanel>

                <!-- Time and Language Panel -->
                <StackPanel x:Name="TimeLanguagePanel" Visibility="Collapsed">
                    <TextBlock Text="{DynamicResource Str_TimeLanguage}" Style="{StaticResource MetroHeaderTextStyle}"/>
                    
                    <TextBlock Text="{DynamicResource Str_DateTime}" Style="{StaticResource MetroSubheaderTextStyle}" Margin="0,20,0,10"/>
                    
                    <StackPanel Orientation="Horizontal" Margin="0,0,0,30">
                        <TextBlock Text="{DynamicResource Str_TimeZone}" Style="{StaticResource MetroBodyTextStyle}" VerticalAlignment="Center" Width="150"/>
                        <ComboBox Width="350" Height="30" Style="{StaticResource MetroComboBoxStyle}"
                                  ItemsSource="{Binding AvailableTimeZones}"
                                  SelectedItem="{Binding SelectedTimeZone, Mode=TwoWay}"
                                  DisplayMemberPath="DisplayName"/>
                    </StackPanel>

                    <StackPanel Orientation="Horizontal" Margin="0,0,0,30">
                        <TextBlock Text="{DynamicResource Str_Language}" Style="{StaticResource MetroBodyTextStyle}" VerticalAlignment="Center" Width="150"/>
                        <ComboBox Width="200" Height="30" Style="{StaticResource MetroComboBoxStyle}"
                                  ItemsSource="{Binding AvailableLanguages}"
                                  SelectedItem="{Binding SelectedLanguage, Mode=TwoWay}"/>
                    </StackPanel>
                </StackPanel>

                <!-- About Panel -->
                <StackPanel x:Name="AboutPanel" Visibility="Collapsed">
                    <TextBlock Text="{DynamicResource Str_About}" Style="{StaticResource MetroHeaderTextStyle}"/>
                    
                    <StackPanel Orientation="Horizontal" Margin="0,20,0,20">
                        <TextBlock Text="{DynamicResource Str_AppName}" Style="{StaticResource MetroSubheaderTextStyle}" Margin="0,0,10,0"/>
                        <TextBlock Text="v1.0.0" Style="{StaticResource MetroBodyTextStyle}" VerticalAlignment="Bottom" Margin="0,0,0,4"/>
                    </StackPanel>

                    <TextBlock Style="{StaticResource MetroBodyTextStyle}" Margin="0,0,0,20" Text="{DynamicResource Str_AboutDesc}"/>

                    <TextBlock Text="{DynamicResource Str_Features}" Style="{StaticResource MetroSubheaderTextStyle}" Margin="0,20,0,10"/>
                    <TextBlock Style="{StaticResource MetroBodyTextStyle}">
                        <Run Text="{DynamicResource Str_Feature1}"/><LineBreak/>
                        <Run Text="{DynamicResource Str_Feature2}"/><LineBreak/>
                        <Run Text="{DynamicResource Str_Feature3}"/><LineBreak/>
                        <Run Text="{DynamicResource Str_Feature4}"/>
                    </TextBlock>
                </StackPanel>
                
                <!-- Placeholder for other panels -->
                <StackPanel x:Name="PlaceholderPanel" Visibility="Collapsed">
                    <TextBlock x:Name="PlaceholderTitle" Text="Category" Style="{StaticResource MetroHeaderTextStyle}"/>
                    <TextBlock Text="{DynamicResource Str_NotImplemented}" Style="{StaticResource MetroBodyTextStyle}" Margin="0,20,0,0"/>
                </StackPanel>
            </Grid>
        </ScrollViewer>
    </Grid>
</UserControl>